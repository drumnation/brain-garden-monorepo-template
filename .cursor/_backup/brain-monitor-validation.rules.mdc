---
description: Mandatory workflow for checking brain-monitor validation reports before running any validation commands. Prevents redundant work and provides centralized error tracking via _errors/ directory.
globs: ['**/*.ts', '**/*.tsx', '**/*.js', '**/*.jsx']
alwaysApply: true
---

# Brain Monitor Error Checking Rules

## üß† MANDATORY: Check Brain Monitor Reports First

Before running ANY validation commands, ALWAYS check the brain-monitor reports:

```bash
# 1. Check overall validation status FIRST
cat _errors/validation-summary.md

# 2. Check specific error reports if needed
cat _errors/reports/errors.typecheck-failures.md
cat _errors/reports/errors.test-failures-*.md
cat _errors/reports/errors.lint-failures.md
cat _errors/reports/errors.format-failures.md
```

## üìÅ Brain Monitor Directory Structure

```txt
_errors/
‚îú‚îÄ‚îÄ validation-summary.md      # Overall status - check this FIRST
‚îú‚îÄ‚îÄ reports/                   # Detailed error reports
‚îÇ   ‚îú‚îÄ‚îÄ errors.typecheck-failures.md
‚îÇ   ‚îú‚îÄ‚îÄ errors.lint-failures.md
‚îÇ   ‚îú‚îÄ‚îÄ errors.format-failures.md
‚îÇ   ‚îî‚îÄ‚îÄ errors.test-failures-*.md
‚îî‚îÄ‚îÄ .counts/                   # Hidden run count tracking

_logs/                         # Real-time server logs
‚îî‚îÄ‚îÄ [app-name].log
```

## üöÄ Brain Monitor Commands

| Task | Command | Output Location |
|------|---------|-----------------|
| All Validations | `pnpm brain:validate` | `_errors/validation-summary.md` |
| Watch Mode (Fast) | `pnpm brain:watch` | `_errors/watch-summary.md` + individual reports |
| Watch Mode (All) | `pnpm brain:watch --all` | `_errors/watch-summary.md` + individual reports |
| TypeScript Only | `pnpm brain:typecheck-failures` | `_errors/reports/errors.typecheck-failures.md` |
| Lint Only | `pnpm brain:lint-failures` | `_errors/reports/errors.lint-failures.md` |
| Format Only | `pnpm brain:format-failures` | `_errors/reports/errors.format-failures.md` |
| Unit Tests | `pnpm brain:test-failures-unit` | `_errors/reports/errors.test-failures-unit.md` |
| Integration Tests | `pnpm brain:test-failures-integration` | `_errors/reports/errors.test-failures-integration.md` |
| E2E Tests | `pnpm brain:test-failures-e2e` | `_errors/reports/errors.test-failures-e2e.md` |
| Server Logs | `pnpm brain:logs [app]?` | Real-time log monitoring |

## ‚ö° Efficiency Rules

1. **ALWAYS** check `validation-summary.md` first - it has error counts for all validations
2. **ONLY** run validations if reports are stale (>10 minutes old) or don't exist
3. **NEVER** run `pnpm brain:validate` if you only need to check one type of error
4. **USE** specific commands (`brain:typecheck-failures`, etc.) for targeted validation
5. **PREFER** `pnpm brain:watch` for continuous feedback during development
6. **CHECK** `watch-summary.md` when watch mode is active

### How to Check if Reports are Stale

```bash
# Check if validation-summary.md is older than 10 minutes
if [ -f _errors/validation-summary.md ]; then
  AGE=$(find _errors/validation-summary.md -mmin +10 2>/dev/null | wc -l)
  if [ "$AGE" -eq 1 ]; then
    echo "Reports are stale, running validation..."
    pnpm brain:validate
  else
    echo "Reports are fresh, reading existing reports..."
    cat _errors/validation-summary.md
  fi
else
  echo "No reports found, running initial validation..."
  pnpm brain:validate
fi
```

## üîÑ Workflow

1. Check summary: `cat _errors/validation-summary.md`
2. If errors exist, check specific report: `cat _errors/reports/errors.[type]-failures.md`
3. Fix errors based on the report (see Related Rules section for fixing guidance)
4. Run ONLY the specific validation: `pnpm brain:[type]-failures`
5. Repeat until clean

Remember: The reports are your task lists - read them first, run commands second!

### Error Handling

**If `_errors/` directory doesn't exist:**
```bash
# Brain-monitor will create it on first run
pnpm brain:validate
```

**If brain-monitor package isn't installed:**
```bash
# Install it first
pnpm install
# Then run validation
pnpm brain:validate
```

**If validation-summary.md exists but specific report is missing:**
```bash
# Run the specific validation to regenerate it
pnpm brain:typecheck-failures  # or whichever is missing
```

### Example: validation-summary.md Content

```markdown
# Validation Summary

Last updated: 2025-01-15 14:30:22

## Status Overview
- ‚úÖ TypeScript: 0 errors
- ‚ö†Ô∏è  Linting: 3 warnings
- ‚ùå Tests: 2 failures
- ‚úÖ Formatting: 0 issues

## Quick Actions
- Fix test failures: `cat _errors/reports/errors.test-failures-unit.md`
- Review lint warnings: `cat _errors/reports/errors.lint-failures.md`

## Next Steps
1. Fix failing tests in packages/auth
2. Address lint warnings in apps/client
```

---

## üîó Related Rules (Testing Trio)

This rule is part of the **Testing Trio** that provides comprehensive auto-validation:

1. **`brain-monitor-validation.rules.mdc`** (THIS RULE) - Coordinates agent communication via `_errors/` reports
2. **`tests.continuous-validation.rules.mdc`** - Auto-executes tests after changes
3. **`tests.unified-testing.rules.mdc`** - Ensures TDD methodology and test quality

### The Complete Auto-Validation Workflow

**STEP 1: Check Reports First** (brain-monitor)
```bash
cat _errors/validation-summary.md  # Check overall status
```

**STEP 2: Fix Issues** (unified-testing)
- Follow TDD 5-step process for new tests
- Use proper test patterns and quality standards

**STEP 3: Auto-Validation** (continuous-validation)
- Tests run automatically after changes
- Results written back to `_errors/` reports

**STEP 4: Repeat**
- Check reports again
- Fix remaining issues
- Continuous feedback loop

### Why All Three Rules?

**Without brain-monitor:** Agents waste time re-running validations
**Without continuous-validation:** Tests must be run manually
**Without unified-testing:** Tests are low-quality and brittle

**Together:** You get the "full king treatment" - automatic, high-quality validation with minimal effort.

---

## üìñ Error-Fixing Quick Reference

When reports show errors, consult these rules for fixing guidance:

| Error Type | Relevant Rule | Purpose |
|------------|---------------|---------|
| Test failures | `tests.unified-testing.rules.mdc` | TDD workflow, test patterns |
| TypeScript errors | `monorepo-structure-and-configuration.rules.mdc` | TypeScript configuration |
| Lint errors | (ESLint config in `/tooling`) | Code style standards |
| Format errors | (Prettier config in `/tooling`) | Code formatting rules |
| Component issues | `component-design-decision-tree.rules.mdc` | UI component patterns |

**Pro Tip:** After fixing errors, re-run ONLY the specific validation:
```bash
# Fixed TypeScript errors? Only run:
pnpm brain:typecheck-failures

# Fixed tests? Only run:
pnpm brain:test-failures-unit
```
